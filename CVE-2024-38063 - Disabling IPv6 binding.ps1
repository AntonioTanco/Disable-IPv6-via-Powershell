#CVE-2024-38063 - Disabling IPv6 binging.ps1
#Author: Antonio T
#Github: https://github.com/antoniotanco

#Get all the network adapters that are enabled and have IPv6 Protocol enabled
$adapters = Get-NetAdapter | Where-Object {$_.Status -eq "Up" -and (Get-NetAdapterBinding -ComponentID ms_tcpip6).Enabled}

#Interate through each NIC
foreach ($adapter in $adapters) {

    #Disable IPv6 for each network adapter
    Disable-NetAdapterBinding -Name ($adapter.Name) -ComponentID "ms_tcpip6"

    #Print to console the results of what network adapter had IPv6 disabled
    Write-Host "Ipv6 has been disabled for network adapter: $($adapter.Name)"

}